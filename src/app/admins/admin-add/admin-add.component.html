<div class="container mt-4">
  <h2>Add New {{ role }}</h2>

  <form [formGroup]="userForm" (ngSubmit)="onSubmit()" novalidate>

    <!-- First Name -->
    <div class="mb-3">
      <label for="firstName" class="form-label">First Name *</label>
      <input
        type="text"
        id="firstName"
        formControlName="firstName"
        class="form-control"
        [class.is-invalid]="f['firstName'].touched && f['firstName'].invalid"
        aria-describedby="firstNameFeedback"
        autocomplete="given-name"
      />
      <div *ngIf="f['firstName'].touched && f['firstName'].invalid" id="firstNameFeedback" class="invalid-feedback">
        First Name is required.
      </div>
    </div>

    <!-- Last Name -->
    <div class="mb-3">
      <label for="lastName" class="form-label">Last Name *</label>
      <input
        type="text"
        id="lastName"
        formControlName="lastName"
        class="form-control"
        [class.is-invalid]="f['lastName'].touched && f['lastName'].invalid"
        aria-describedby="lastNameFeedback"
        autocomplete="family-name"
      />
      <div *ngIf="f['lastName'].touched && f['lastName'].invalid" id="lastNameFeedback" class="invalid-feedback">
        Last Name is required.
      </div>
    </div>

    <!-- Email -->
    <div class="mb-3">
      <label for="email" class="form-label">Email *</label>
      <input
        type="email"
        id="email"
        formControlName="email"
        class="form-control"
        [class.is-invalid]="f['email'].touched && f['email'].invalid"
        aria-describedby="emailFeedback"
        autocomplete="email"
      />
      <div *ngIf="f['email'].touched && f['email'].invalid" id="emailFeedback" class="invalid-feedback">
        Valid email is required.
      </div>
    </div>

    <!-- Gender radios -->
    <div class="mb-3">
      <label class="form-label d-block">Gender *</label>

      <div class="form-check form-check-inline">
        <input
          class="form-check-input"
          type="radio"
          id="genderMale"
          formControlName="gender"
          value="Male"
        />
        <label class="form-check-label" for="genderMale">Male</label>
      </div>

      <div class="form-check form-check-inline">
        <input
          class="form-check-input"
          type="radio"
          id="genderFemale"
          formControlName="gender"
          value="Female"
        />
        <label class="form-check-label" for="genderFemale">Female</label>
      </div>

      <div class="form-check form-check-inline">
        <input
          class="form-check-input"
          type="radio"
          id="genderOther"
          formControlName="gender"
          value="Other"
        />
        <label class="form-check-label" for="genderOther">Other</label>
      </div>

      <div *ngIf="f['gender'].touched && f['gender'].invalid" class="text-danger mt-1">
        Please select a gender.
      </div>
    </div>

    <!-- Contact -->
    <div class="mb-3">
      <label for="contact" class="form-label">Contact</label>
      <input
        type="text"
        id="contact"
        formControlName="contact"
        class="form-control"
        [class.is-invalid]="f['contact'].touched && f['contact'].invalid"
        aria-describedby="contactFeedback"
        autocomplete="tel"
      />
      <div *ngIf="f['contact'].touched && f['contact'].invalid" id="contactFeedback" class="invalid-feedback">
        Please enter a valid phone number.
      </div>
    </div>

    <!-- Doctor-specific fields -->
    <div *ngIf="role === 'Doctor'">
      <div class="mb-3">
        <label for="departmentId" class="form-label">Department *</label>
        <select
          id="departmentId"
          formControlName="departmentId"
          class="form-select"
          [class.is-invalid]="f['departmentId'].touched && f['departmentId'].invalid"
          aria-describedby="departmentFeedback"
        >
          <option value="" disabled>Select Department</option>
          <option *ngFor="let dept of departments" [value]="dept.departmentId">
            {{ dept.departmentName }}
          </option>
        </select>
        <div *ngIf="f['departmentId'].touched && f['departmentId'].invalid" id="departmentFeedback" class="invalid-feedback">
          Department is required.
        </div>
      </div>

      <div class="mb-3">
        <label for="doctorFee" class="form-label">Doctor Fee *</label>
        <input
          id="doctorFee"
          type="number"
          formControlName="doctorFee"
          min="0"
          class="form-control"
          [class.is-invalid]="f['doctorFee'].touched && f['doctorFee'].invalid"
          aria-describedby="doctorFeeFeedback"
          readonly
        />
        <div *ngIf="f['doctorFee'].touched && f['doctorFee'].invalid" id="doctorFeeFeedback" class="invalid-feedback">
          Doctor fee is required and must be zero or greater.
        </div>
      </div>
    </div>

    <!-- Is Active -->
    <div class="form-check mb-3">
      <input
        type="checkbox"
        id="isActive"
        formControlName="isActive"
        class="form-check-input"
      />
      <label for="isActive" class="form-check-label">Active</label>
    </div>

    <button type="submit" class="btn btn-primary" [disabled]="submitting">
      {{ submitting ? 'Saving...' : 'Save' }}
    </button>
    <button type="button" class="btn btn-secondary ms-2" (click)="cancel()" [disabled]="submitting">
      Cancel
    </button>
  </form>
</div>
